<ion-header class="ion-no-border" [translucent]="true">
  <ion-toolbar>
    <ion-title>
      <h1 class="text-2xl font-bold ml-2">Coordenadas de Ajedrez</h1>
    </ion-title>
    <ion-buttons slot="end">
      <ion-button class="btn-ghost">
        <ion-icon name="settings-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">
  
  <div id="theme-target" class="theme-wrapper" appThemeApply>



    <ion-grid class="ion-margin-top">
      <ion-row>
  
        <ion-col size="12" size-sm="12" size-md="12" size-lg="6" size-xl="6" offset-lg="2" offset-xl="2">
  
              <lib-board (squareSelected)="onSquareSelected($event)"></lib-board>
              <h1 class="current-puzzle">
                {{ currentPuzzle }}
              </h1>
  
  
              <div class="flex items-center mt-2 ">
                <progress 
                  class="progress w-full"
                  [ngClass]="{
                    'progress-success': timeColor === 'success',
                    'progress-warning': timeColor === 'warning',
                    'progress-error': timeColor === 'danger'
                  }"
                  [value]="progressValue * 100" 
                  max="100">
                </progress>
                <p 
                  class="text-sm ml-2 whitespace-nowrap"
                  [ngClass]="{
                    'text-success': timeColor === 'success',
                    'text-warning': timeColor === 'warning',
                    'text-error': timeColor === 'danger'
                  }"
                >
                  {{time | number:'1.0-0'}}
                </p>
              </div>
  
        </ion-col>
  
        <ion-col size="12" size-sm="12" size-md="12" size-lg="4" size-xl="4" >

          <div class="flex justify-between items-center">

            <div class="join join-horizontal">
              <button 
                class="join-item btn btn-sm" 
                [class.btn-soft]="boardOrientation === 'white'"
                [class.btn-ghost]="boardOrientation !== 'white'"
                (click)="changeBoardOrientation('white')"
              >
                <img src="assets/images/pieces/cburnett/wK.svg" alt="White King" class="size-6">
              </button>
              <button 
                class="join-item btn btn-sm" 
                [class.btn-soft]="boardOrientation === 'random'"
                [class.btn-ghost]="boardOrientation !== 'random'"
                (click)="changeBoardOrientation('random')"
              >
                <ion-icon name="shuffle-outline" class="size-6"></ion-icon>
              </button>
            
              <button 
                class="join-item btn btn-sm" 
                [class.btn-soft]="boardOrientation === 'black'"
                [class.btn-ghost]="boardOrientation !== 'black'"
                (click)="changeBoardOrientation('black')"
              >
                <img src="assets/images/pieces/cburnett/bK.svg" alt="Black King" class="size-6">
              </button>
            </div>
          
          </div>

          
          <div class="flex flex-col justify-center items-center gap-2 mt-2">
            

           
            
            <button class="btn btn-lg btn-primary w-full" (click)="play()">Jugar</button>

            <div class="stats stats-horizontal shadow w-full mt-2">
              <div class="stat place-items-center">
                <div class="stat-title">Blancas</div>
                <div class="stat-value text-primary">{{ getBestScoreByColor('w') }}</div>
                <div class="stat-desc">{{ getBestScoreTimeByColor('w') }}</div>
              </div>
            
              <div class="stat place-items-center">
                <div class="stat-title">Negras</div>
                <div class="stat-value">{{ getBestScoreByColor('b') }}</div>
                <div class="stat-desc">{{ getBestScoreTimeByColor('b') }}</div>
              </div>
            
            </div>

            <!-- Mejores puntajes generales -->
            <div class="w-full mt-4">
              <h3 class="text-lg font-bold mb-2 text-center">Mejores Puntajes</h3>
              <div class="space-y-2">
                <div 
                  *ngFor="let score of bestScores; let i = index" 
                  class="flex justify-between items-center p-2 bg-base-200 rounded-lg"
                >
                  <div class="flex items-center gap-2">
                    <span class="text-sm font-bold text-primary">#{{ i + 1 }}</span>
                    <span class="text-sm">{{ score.score }} puntos</span>
                  </div>
                  <div class="text-xs text-base-content/70">
                    {{ score.timeAgo }}
                  </div>
                </div>
                
                <div *ngIf="bestScores.length === 0" class="text-center text-sm text-base-content/70 py-4">
                  No hay puntajes aún. ¡Juega tu primera partida!
                </div>
              </div>
            </div>
          </div>
  
        </ion-col>
  
      </ion-row>
    </ion-grid>

  </div>

</ion-content>